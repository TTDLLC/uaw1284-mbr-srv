<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title><%= typeof title !== 'undefined' ? title : 'UAW Local 1284 Membership Portal' %></title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <header class="site-header">
    <nav class="nav">
      <a href="/" class="brand">UAW Local 1284</a>
      <a href="/about">About</a>
      <% if (currentUser && (currentUser.role === 'admin' || currentUser.role === 'staff')) { %>
        <a href="/admin/audit">Audit Log</a>
      <% } %>
      <a href="/api/health" target="_blank" rel="noopener">Health</a>
    </nav>
    <div class="auth-banner">
      <% if (currentUser) { %>
        <span class="signed-in">Signed in as <strong><%= currentUser.name || currentUser.email %></strong> (<%= currentUser.role %>)</span>
        <form method="post" action="/api/auth/logout" class="logout-form">
          <input type="hidden" name="_csrf" value="<%= csrfToken %>">
          <button type="submit">Log out</button>
        </form>
      <% } else { %>
        <span class="signed-out">Not signed in. Use API clients to authenticate.</span>
      <% } %>
    </div>
  </header>

  <main class="container">
    <%- body %>
  </main>

  <footer class="site-footer">UAW 1284 Membership Server â€¢ <%= new Date().getFullYear() %></footer>
  <script src="/js/index.js" defer></script>
</body>
</html>
